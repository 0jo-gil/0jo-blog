---
title: "[React] 토스의 퍼널 관리 방식 (@toss/useFunnel)"
date: "2023-12-25"
category: "React"
summary: "토스 라이브러리 useFunnel을 간단하게 분석해보자."
slug: "react-toss-use-funnel"
---


## 시작하며

토스의 다양한 기술을 소개하는 SLASH23에서 가장 흥미로웠던 [퍼널: 쏟아지는 페이지 한 방에 관리하기](https://toss.im/slash-23/session-detail/A1-3) 대한 발표를 보게되었고 간단하게 소개와 함께 분석을 해보려고 한다.

**_'라이브러리를 구현하고 만들어보자'_** 라는 막연한 생각은 항상 해왔었기 때문에 이번을 계기로 더 넓은 시각을 가지고 개발을 해봐야겠다는 생각을 했다.

발표영상에서 쏟아지는 여러 페이지를 효과적으로 관리할 수 있는 방법론을 고민하고 구현 방식에 대한 소개를 하고 있다.

---

## 상황

간단하게 회원가입 페이지에 대한 흐름을 생각해보자

> 아이디 -> 비밀번호 -> 이름

위 정보를 입력하는 페이지가 각 단일 페이지로 있다고 가정해보자.

그럼 각각 존재하는 페이지에서 입력받은 데이터를 어떻게 관리할 것이며, 회원가입에서 요구되는 정보가 추가된다면 새롭게 생성되는 페이지를 모두 관리하기엔 복잡도가 상승할 것이다.

## 해결

토스 퍼널 관리 발표영상을 보면서 개인적인 관점으로 해결 방식에 대한 분석입니다.

### 각 퍼널 페이지를 SPA 처럼 관리하기

하나의 페이지에 각 step에 대한 분기처리를 통해 하나의 작은 SPA 처럼 유연하게 관리하고 추가되는 페이지 (step)에 대한 처리 역시 간단하게 할 수 있다는 점을 알 수 있었다. 이러한 방식은 전체적인 UI 흐름 파악을 직관적으로 할 수 있어보였고 각 페이지에서 발생하는 이벤트 처리 역시 유연하게 관리할 수 있었다.

### 추상화

위와 같이 만들어진 기능에서 공통적으로 사용되는 로직만 추상화하여 정의하는 과정이 있었다.

1. 조건부 렌더링에 대한 추상화를 진행하였고 '해당 조건과 일치하면 컴포넌트를 보여줘'

2. 해당 컴포넌트의 추상화와 함께 상태를 관리할 수 있는 커스텀 훅 [useFunnel](https://slash.page/ko/libraries/react/use-funnel/README.i18n) 을 생성하여 해당 스텝에 대한 정보 등을 관리한다.

3. 위에서 구현된 방식을 살펴보면 단일 URL로 조건부 렌더링이 진행되므로 스텝 과정에서의 뒤로가기, 앞으로 가기에 대한 관리 포인트가 필요했다. 이러한 문제 해결방식은 쿼리파라미터를 업데이트하여 해당 스텝에 대한 정보와 함께 페이지 히스토리를 관리할 수 있었다.

---

## 마치면서

개발자로써 문제 상황에 대한 인지와 여러가지 해결방식에 대한 고민을 한다. 내가 미처 생각하지 못한 다양한 방식을 새로운 관점에서 매년 토스의 발표영상을 통해 배우고 또 그 방식을 내 나름대로 해석하고 발전시킬 수 있는 방향에 대한 발전가능성 있는 고민의 시간을 가지고 또 다른 방식의 해결 방식을 항상 고민하는 개발자가 되어야겠다.

조만간 퍼널 페이지를 내 나름대로의 방식으로 구현하고 라이브러리화 시킬 수 있는 방식에 대한 포스팅으로 정리해보려한다.
